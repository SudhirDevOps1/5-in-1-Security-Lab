<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Attack Simulator â€” 5-in-1 Security Lab</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <style>
        *{box-sizing:border-box}
        body{font-family:'Inter',sans-serif;scroll-behavior:smooth}
        .mono{font-family:'JetBrains Mono',monospace}
        @keyframes pulseRed{0%,100%{box-shadow:0 0 0 0 rgba(239,68,68,.4)}50%{box-shadow:0 0 20px 10px rgba(239,68,68,.1)}}
        @keyframes pulseGreen{0%,100%{box-shadow:0 0 0 0 rgba(34,197,94,.4)}50%{box-shadow:0 0 20px 10px rgba(34,197,94,.1)}}
        @keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
        @keyframes glitch{0%{transform:translate(0)}20%{transform:translate(-2px,2px)}40%{transform:translate(2px,-2px)}60%{transform:translate(-1px,-1px)}80%{transform:translate(1px,1px)}100%{transform:translate(0)}}
        @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}
        @keyframes fadeIn{from{opacity:0}to{opacity:1}}
        @keyframes countUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
        @keyframes scanline{0%{top:-100%}100%{top:100%}}
        .animate-slide-up{animation:slideUp .6s ease-out forwards}
        .animate-pulse-red{animation:pulseRed 2s infinite}
        .animate-pulse-green{animation:pulseGreen 2s infinite}
        .animate-shake{animation:shake .5s ease}
        .animate-fade-in{animation:fadeIn .4s ease-out forwards}
        .glitch:hover{animation:glitch .3s ease infinite}
        .glass{background:rgba(255,255,255,.05);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.1)}
        .glass-strong{background:rgba(255,255,255,.08);backdrop-filter:blur(30px);border:1px solid rgba(255,255,255,.15)}
        .gradient-text{background:linear-gradient(135deg,#f97316,#ef4444,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .gradient-text-blue{background:linear-gradient(135deg,#3b82f6,#8b5cf6);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .gradient-text-green{background:linear-gradient(135deg,#22c55e,#06b6d4);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .gradient-text-yellow{background:linear-gradient(135deg,#eab308,#f97316);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .gradient-text-purple{background:linear-gradient(135deg,#a855f7,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .demo-frame{border:2px solid #334155;border-radius:12px;overflow:hidden}
        .demo-titlebar{background:#1e293b;padding:8px 12px;display:flex;align-items:center;gap:6px}
        .demo-dot{width:10px;height:10px;border-radius:50%}
        ::-webkit-scrollbar{width:6px}
        ::-webkit-scrollbar-track{background:#0f172a}
        ::-webkit-scrollbar-thumb{background:#475569;border-radius:4px}
        .card-hover:hover{transform:translateY(-4px);box-shadow:0 20px 40px rgba(0,0,0,.3)}
        .card-hover{transition:all .3s ease}
        .tab-active{transform:translateY(-2px)}
        .severity-bar{height:8px;border-radius:9999px;background:#1e293b;overflow:hidden}
        .severity-fill{height:100%;border-radius:9999px;transition:width 1s ease}
        .code-block{background:#0d1117;border:1px solid #30363d;border-radius:12px;overflow:hidden}
        .code-header{background:#161b22;border-bottom:1px solid #30363d;padding:10px 16px;display:flex;justify-content:space-between;align-items:center}
        .code-body{padding:16px;overflow-x:auto;white-space:pre;font-size:13px;line-height:1.6}
        .progress-ring{transform:rotate(-90deg)}
        .section-divider{height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent)}
        .search-highlight{background:rgba(234,179,8,.3);border-radius:2px;padding:0 2px}
    </style>
</head>
<body class="bg-gray-950 text-gray-100 min-h-screen">

<div id="app">
    <div class="min-h-screen flex items-center justify-center">
        <div class="text-center animate-fade-in">
            <div class="text-6xl mb-4 animate-pulse">ğŸ›¡ï¸</div>
            <p class="text-gray-400">Loading Security Lab...</p>
        </div>
    </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CONFIG LOADER â€” Loads from config.json with fallback
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let CONFIG = null;
let activeAttack = 0;
let quizState = { current: 0, score: 0, answered: false };
let progressData = {};
let searchQuery = '';
let activeSection = 'all';
let tabNabbed = false;
let overlayVisible = false;

async function loadConfig() {
    try {
        const resp = await fetch('config.json');
        if (!resp.ok) throw new Error('Failed to load');
        CONFIG = await resp.json();
    } catch(e) {
        console.warn('config.json not found, using embedded config. Error:', e.message);
        CONFIG = getEmbeddedConfig();
    }
    activeAttack = CONFIG.site.defaultAttack || 0;
    loadProgress();
    renderApp();
}

function getEmbeddedConfig() {
    return {
        site: { title: "Cyber Attack Simulator", subtitle: "5-in-1 Security Lab", logo: "ğŸ›¡ï¸", description: "Interactive security education lab.", footerText: "Educational Purpose Only", footerSubtext: "", defaultAttack: 0, showHeroStats: true, showComparisonTable: true, showGlossary: true, showProgressTracker: true },
        theme: { bodyBg: "bg-gray-950", accentGradient: "from-orange-500 via-red-500 to-pink-500" },
        heroStats: [{ value: "3.4B+", label: "Phishing Emails/Day", icon: "ğŸ“§" }],
        attacks: [{ id: "demo", name: "Demo Attack", shortName: "Demo", tagline: "Demo", icon: "ğŸ”´", color: "red", severity: 5, description: "Please provide a valid config.json file.", tldr: "Config not loaded.", howItWorks: [], examples: [], prevention: [], quiz: [], codeSnippets: { vulnerable: { title: "", lang: "", code: "" }, secure: { title: "", lang: "", code: "" } }, realWorldCases: [] }],
        comparisonTable: { headers: [], rows: [] },
        glossary: []
    };
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  HELPER FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function colorMap(color, type) {
    const map = {
        gradient: { red:'from-red-500 to-orange-500', blue:'from-blue-500 to-purple-500', green:'from-green-500 to-cyan-500', yellow:'from-yellow-500 to-orange-500', purple:'from-purple-500 to-pink-500' },
        border: { red:'border-red-500', blue:'border-blue-500', green:'border-green-500', yellow:'border-yellow-500', purple:'border-purple-500' },
        bg: { red:'bg-red-500/10', blue:'bg-blue-500/10', green:'bg-green-500/10', yellow:'bg-yellow-500/10', purple:'bg-purple-500/10' },
        text: { red:'text-red-400', blue:'text-blue-400', green:'text-green-400', yellow:'text-yellow-400', purple:'text-purple-400' },
        gradientText: { red:'gradient-text', blue:'gradient-text-blue', green:'gradient-text-green', yellow:'gradient-text-yellow', purple:'gradient-text-purple' },
        solid: { red:'bg-red-500', blue:'bg-blue-500', green:'bg-green-500', yellow:'bg-yellow-500', purple:'bg-purple-500' },
        ring: { red:'ring-red-500/30', blue:'ring-blue-500/30', green:'ring-green-500/30', yellow:'ring-yellow-500/30', purple:'ring-purple-500/30' }
    };
    return (map[type] && map[type][color]) || 'bg-gray-500';
}

function dangerBadge(level) {
    const c = { critical:'bg-red-600', high:'bg-orange-500', medium:'bg-yellow-600', low:'bg-green-500' };
    return `<span class="px-2 py-0.5 rounded-full text-[10px] font-bold ${c[level]||c.medium} text-white uppercase tracking-wider">${level}</span>`;
}

function prioColor(p) {
    return { critical:'border-red-500 bg-red-500/5', high:'border-orange-500 bg-orange-500/5', medium:'border-yellow-500 bg-yellow-500/5' }[p] || 'border-gray-500';
}

function severityColor(s) {
    if (s >= 9) return 'from-red-500 to-red-600';
    if (s >= 7) return 'from-orange-500 to-red-500';
    if (s >= 5) return 'from-yellow-500 to-orange-500';
    return 'from-green-500 to-yellow-500';
}

function severityLabel(s) {
    if (s >= 9) return 'Critical';
    if (s >= 7) return 'High';
    if (s >= 5) return 'Medium';
    return 'Low';
}

// Progress persistence
function loadProgress() {
    try {
        const saved = localStorage.getItem('cyberlab_progress');
        if (saved) progressData = JSON.parse(saved);
    } catch(e) {}
}
function saveProgress() {
    try { localStorage.setItem('cyberlab_progress', JSON.stringify(progressData)); } catch(e) {}
}
function getOverallProgress() {
    let total = 0, completed = 0;
    CONFIG.attacks.forEach(a => {
        if (a.quiz && a.quiz.length) {
            total++;
            if (progressData[a.id] && progressData[a.id].completed) completed++;
        }
    });
    return { total, completed, pct: total ? Math.round((completed / total) * 100) : 0 };
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MAIN RENDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderApp() {
    const app = document.getElementById('app');
    document.title = CONFIG.site.title + ' â€” ' + CONFIG.site.subtitle;
    let h = '';

    // â”€â”€ NAVBAR â”€â”€
    h += `<nav class="fixed top-0 w-full z-50 glass-strong border-b border-gray-800/50">
        <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center gap-3 cursor-pointer" onclick="scrollToTop()">
                <span class="text-3xl">${CONFIG.site.logo}</span>
                <div><h1 class="font-bold text-lg gradient-text">${CONFIG.site.title}</h1>
                <p class="text-[11px] text-gray-500 hidden sm:block">${CONFIG.site.subtitle}</p></div>
            </div>
            <div class="hidden xl:flex items-center gap-1">
                ${CONFIG.attacks.map((a,i)=>`<button onclick="switchAttack(${i})" class="attack-tab px-3 py-1.5 rounded-lg text-xs font-medium transition-all duration-300 ${i===activeAttack?'bg-gradient-to-r '+colorMap(a.color,'gradient')+' text-white shadow-lg tab-active':'text-gray-400 hover:text-white hover:bg-gray-800'}" data-tab="${i}">${a.icon} ${a.shortName}</button>`).join('')}
            </div>
            <div class="flex items-center gap-2">
                <button onclick="toggleSearch()" class="p-2 rounded-lg hover:bg-gray-800 text-gray-400 hover:text-white transition" title="Search">ğŸ”</button>
                <button onclick="scrollToSection('progress')" class="p-2 rounded-lg hover:bg-gray-800 text-gray-400 hover:text-white transition hidden sm:block" title="Progress">ğŸ“Š</button>
                <button onclick="document.getElementById('mobMenu').classList.toggle('hidden')" class="xl:hidden p-2 rounded-lg hover:bg-gray-800 text-gray-400 text-xl">â˜°</button>
            </div>
        </div>
        <div id="mobMenu" class="hidden xl:hidden px-4 pb-3 space-y-1 border-t border-gray-800/50 pt-2">
            ${CONFIG.attacks.map((a,i)=>`<button onclick="switchAttack(${i});document.getElementById('mobMenu').classList.add('hidden')" class="block w-full text-left px-3 py-2 rounded-lg text-sm transition ${i===activeAttack?'bg-gradient-to-r '+colorMap(a.color,'gradient')+' text-white':'text-gray-400 hover:bg-gray-800'}">${a.icon} ${a.name}</button>`).join('')}
            <div class="border-t border-gray-800 pt-2 mt-2 flex gap-2">
                <button onclick="scrollToSection('comparison');document.getElementById('mobMenu').classList.add('hidden')" class="flex-1 px-3 py-2 rounded-lg text-sm text-gray-400 hover:bg-gray-800">ğŸ“Š Compare</button>
                <button onclick="scrollToSection('glossary');document.getElementById('mobMenu').classList.add('hidden')" class="flex-1 px-3 py-2 rounded-lg text-sm text-gray-400 hover:bg-gray-800">ğŸ“– Glossary</button>
            </div>
        </div>
        <div id="searchBar" class="hidden px-4 pb-3 border-t border-gray-800/50 pt-2">
            <div class="max-w-xl mx-auto flex gap-2">
                <input type="text" id="searchInput" placeholder="Search attacks, tips, terms..." class="flex-1 px-4 py-2 rounded-xl bg-gray-800 border border-gray-600 focus:border-orange-500 focus:outline-none text-sm transition" onkeyup="handleSearch(event)">
                <button onclick="performSearch()" class="px-4 py-2 bg-gradient-to-r from-orange-500 to-red-500 rounded-xl font-bold text-sm">Search</button>
            </div>
            <div id="searchResults" class="max-w-xl mx-auto mt-2"></div>
        </div>
    </nav>`;

    // â”€â”€ HERO â”€â”€
    h += `<section class="pt-28 pb-12 px-4 relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-b from-orange-500/5 to-transparent pointer-events-none"></div>
        <div class="absolute top-20 left-10 w-72 h-72 bg-orange-500/10 rounded-full blur-3xl pointer-events-none"></div>
        <div class="absolute bottom-0 right-10 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl pointer-events-none"></div>
        <div class="max-w-5xl mx-auto text-center relative z-10">
            <div class="text-7xl mb-4">${CONFIG.site.logo}</div>
            <h1 class="text-4xl md:text-6xl font-black mb-3 gradient-text leading-tight">${CONFIG.site.title}</h1>
            <p class="text-lg md:text-xl text-gray-400 mb-2">${CONFIG.site.subtitle}</p>
            <p class="text-gray-500 max-w-2xl mx-auto mb-8">${CONFIG.site.description}</p>`;

    if (CONFIG.site.showHeroStats && CONFIG.heroStats.length) {
        h += `<div class="grid grid-cols-2 md:grid-cols-4 gap-3 max-w-3xl mx-auto mb-10">
            ${CONFIG.heroStats.map(s=>`<div class="glass rounded-xl p-4 card-hover"><div class="text-2xl mb-1">${s.icon}</div><div class="text-2xl font-black gradient-text">${s.value}</div><div class="text-[11px] text-gray-500 mt-1">${s.label}</div></div>`).join('')}
        </div>`;
    }

    h += `<div class="flex flex-wrap justify-center gap-3">
            ${CONFIG.attacks.map((a,i)=>`<button onclick="switchAttack(${i})" class="group px-5 py-3 rounded-xl font-bold text-sm bg-gradient-to-r ${colorMap(a.color,'gradient')} hover:scale-105 active:scale-95 transition-all shadow-lg shadow-${a.color}-500/20">
                <span class="mr-1">${a.icon}</span> ${a.name}
                <span class="ml-2 px-1.5 py-0.5 rounded-full text-[10px] bg-white/20">${severityLabel(a.severity)}</span>
            </button>`).join('')}
        </div>
        </div>
    </section>`;

    // â”€â”€ PROGRESS TRACKER â”€â”€
    if (CONFIG.site.showProgressTracker) {
        const prog = getOverallProgress();
        h += `<section id="progress" class="max-w-5xl mx-auto px-4 mb-12">
            <div class="glass rounded-2xl p-6">
                <div class="flex flex-col md:flex-row items-center gap-6">
                    <div class="relative">
                        <svg class="progress-ring w-24 h-24" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="42" fill="none" stroke="#1e293b" stroke-width="8"/>
                            <circle cx="50" cy="50" r="42" fill="none" stroke="url(#progGrad)" stroke-width="8" stroke-linecap="round"
                                stroke-dasharray="${2*Math.PI*42}" stroke-dashoffset="${2*Math.PI*42*(1-prog.pct/100)}"/>
                            <defs><linearGradient id="progGrad" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#f97316"/><stop offset="100%" stop-color="#ec4899"/></linearGradient></defs>
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span class="text-xl font-black gradient-text">${prog.pct}%</span>
                        </div>
                    </div>
                    <div class="flex-1 text-center md:text-left">
                        <h3 class="text-lg font-bold mb-1">Your Progress</h3>
                        <p class="text-sm text-gray-400 mb-3">${prog.completed}/${prog.total} quizzes completed</p>
                        <div class="flex flex-wrap gap-2">
                            ${CONFIG.attacks.map(a => {
                                const done = progressData[a.id] && progressData[a.id].completed;
                                const score = progressData[a.id] ? progressData[a.id].score : 0;
                                return `<div class="flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs ${done ? 'bg-green-500/10 border border-green-500/30 text-green-400' : 'bg-gray-800 border border-gray-700 text-gray-500'}">
                                    ${done ? 'âœ…' : 'â¬œ'} ${a.shortName} ${done ? `(${score}/${a.quiz.length})` : ''}
                                </div>`;
                            }).join('')}
                        </div>
                    </div>
                    <button onclick="if(confirm('Reset all progress?')){progressData={};saveProgress();renderApp();}" class="px-4 py-2 rounded-lg bg-gray-800 text-xs text-gray-500 hover:bg-gray-700 hover:text-gray-300 transition">ğŸ”„ Reset</button>
                </div>
            </div>
        </section>`;
    }

    // â”€â”€ ATTACK CONTENT â”€â”€
    h += `<div id="attackContent" class="max-w-6xl mx-auto px-4 pb-8"></div>`;

    // â”€â”€ COMPARISON TABLE â”€â”€
    if (CONFIG.site.showComparisonTable && CONFIG.comparisonTable && CONFIG.comparisonTable.rows && CONFIG.comparisonTable.rows.length) {
        h += `<section id="comparison" class="max-w-6xl mx-auto px-4 pb-12">
            <div class="section-divider mb-12"></div>
            <h2 class="text-3xl font-black text-center mb-8">ğŸ“Š Attack Comparison Matrix</h2>
            <div class="glass rounded-2xl overflow-hidden"><div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead><tr class="bg-gray-800/60">
                        ${CONFIG.comparisonTable.headers.map((h,i) => `<th class="px-4 py-4 text-left text-xs font-bold ${i===0?'text-gray-300':colorMap(CONFIG.attacks[i-1]?.color||'gray','text')} uppercase tracking-wider whitespace-nowrap">${i>0&&CONFIG.attacks[i-1]?CONFIG.attacks[i-1].icon+' ':''} ${h}</th>`).join('')}
                    </tr></thead>
                    <tbody>
                        ${CONFIG.comparisonTable.rows.map((r,ri) => `<tr class="border-t border-gray-800/50 hover:bg-gray-800/20 transition">
                            <td class="px-4 py-3 font-semibold text-gray-300 whitespace-nowrap">${r.feature}</td>
                            ${r.values.map((v,vi) => `<td class="px-4 py-3 text-gray-400 whitespace-nowrap">${v}</td>`).join('')}
                        </tr>`).join('')}
                    </tbody>
                </table>
            </div></div>
        </section>`;
    }

    // â”€â”€ GLOSSARY â”€â”€
    if (CONFIG.site.showGlossary && CONFIG.glossary && CONFIG.glossary.length) {
        h += `<section id="glossary" class="max-w-6xl mx-auto px-4 pb-12">
            <div class="section-divider mb-12"></div>
            <h2 class="text-3xl font-black text-center mb-8">ğŸ“– Security Glossary</h2>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-3">
                ${CONFIG.glossary.map(g => `<div class="glass rounded-xl p-4 card-hover">
                    <h4 class="font-bold text-orange-400 mono text-sm mb-1">${g.term}</h4>
                    <p class="text-xs text-gray-400 leading-relaxed">${g.definition}</p>
                </div>`).join('')}
            </div>
        </section>`;
    }

    // â”€â”€ FOOTER â”€â”€
    h += `<footer class="py-10 px-4 border-t border-gray-800 text-center">
        <div class="text-4xl mb-3">${CONFIG.site.logo}</div>
        <p class="text-gray-400 text-sm font-semibold">${CONFIG.site.footerText}</p>
        ${CONFIG.site.footerSubtext ? `<p class="text-gray-600 text-xs mt-2">${CONFIG.site.footerSubtext}</p>` : ''}
        <div class="flex justify-center gap-4 mt-4">
            ${CONFIG.attacks.map(a => `<span class="text-2xl" title="${a.name}">${a.icon}</span>`).join('')}
        </div>
    </footer>`;

    app.innerHTML = h;
    renderAttack(activeAttack);
}

function scrollToTop() { window.scrollTo({ top: 0, behavior: 'smooth' }); }
function scrollToSection(id) { document.getElementById(id)?.scrollIntoView({ behavior: 'smooth', block: 'start' }); }

function switchAttack(index) {
    activeAttack = index;
    quizState = { current: 0, score: 0, answered: false };
    tabNabbed = false;
    overlayVisible = false;

    document.querySelectorAll('.attack-tab').forEach((t,i) => {
        const a = CONFIG.attacks[i];
        if (!a) return;
        if (i === index) t.className = `attack-tab px-3 py-1.5 rounded-lg text-xs font-medium transition-all duration-300 bg-gradient-to-r ${colorMap(a.color,'gradient')} text-white shadow-lg tab-active`;
        else t.className = 'attack-tab px-3 py-1.5 rounded-lg text-xs font-medium transition-all duration-300 text-gray-400 hover:text-white hover:bg-gray-800';
    });

    renderAttack(index);
    document.getElementById('attackContent').scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ATTACK RENDERER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderAttack(index) {
    const a = CONFIG.attacks[index];
    if (!a) return;
    const container = document.getElementById('attackContent');
    const gt = colorMap(a.color, 'gradientText');
    const gc = colorMap(a.color, 'gradient');
    let h = '';

    // â”€â”€ HEADER + SEVERITY â”€â”€
    h += `<div class="text-center py-10 animate-fade-in">
        <div class="text-7xl mb-4">${a.icon}</div>
        <h2 class="text-3xl md:text-5xl font-black mb-2"><span class="${gt}">${a.name}</span></h2>
        <p class="text-xl text-gray-400 mb-2 italic">"${a.tagline}"</p>
        <p class="text-gray-500 max-w-2xl mx-auto mb-4">${a.description}</p>
        <div class="max-w-xs mx-auto mb-2">
            <div class="flex justify-between text-xs mb-1"><span class="text-gray-500">Severity</span><span class="${colorMap(a.color,'text')} font-bold">${a.severity}/10 â€” ${severityLabel(a.severity)}</span></div>
            <div class="severity-bar"><div class="severity-fill bg-gradient-to-r ${severityColor(a.severity)}" style="width:${a.severity*10}%"></div></div>
        </div>
        <div class="inline-block px-4 py-2 rounded-full glass text-xs text-gray-400 mt-2">ğŸ’¡ <strong>TL;DR:</strong> ${a.tldr}</div>
    </div>`;

    // â”€â”€ SECTION NAV â”€â”€
    const sections = ['how','demo','examples','code','cases','prevention','quiz'];
    const sectionLabels = { how:'âš™ï¸ How It Works', demo:'ğŸ”¬ Interactive Demo', examples:'ğŸ“‹ Examples', code:'ğŸ’» Code Snippets', cases:'ğŸ“° Real Cases', prevention:'ğŸ›¡ï¸ Prevention', quiz:'ğŸ§  Quiz' };
    h += `<div class="flex flex-wrap justify-center gap-2 mb-10 sticky top-[60px] z-30 py-3 bg-gray-950/80 backdrop-blur-lg">
        ${sections.map(s => `<button onclick="scrollToSection('section-${s}')" class="px-3 py-1.5 rounded-full text-xs glass hover:bg-gray-800 text-gray-400 hover:text-white transition">${sectionLabels[s]}</button>`).join('')}
    </div>`;

    // â”€â”€ HOW IT WORKS â”€â”€
    if (a.howItWorks && a.howItWorks.length) {
        h += `<div id="section-how" class="mb-16 scroll-mt-28">
            <h3 class="text-2xl font-black mb-8 text-center">âš™ï¸ How This Attack Works</h3>
            <div class="relative">
                <div class="absolute left-7 top-0 bottom-0 w-0.5 bg-gradient-to-b ${gc} hidden md:block"></div>
                <div class="space-y-4">
                    ${a.howItWorks.map((s,i) => `
                    <div class="flex gap-5 items-start glass rounded-2xl p-5 card-hover ml-0 md:ml-6 animate-fade-in" style="animation-delay:${i*0.1}s">
                        <div class="flex-shrink-0 w-14 h-14 rounded-xl bg-gradient-to-br ${gc} flex items-center justify-center text-xl font-black shadow-lg">${s.step}</div>
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1"><span class="text-xl">${s.icon}</span><h4 class="text-lg font-bold">${s.title}</h4></div>
                            <p class="text-gray-300 text-sm">${s.desc}</p>
                            <p class="text-gray-500 text-xs mt-2 italic border-l-2 ${colorMap(a.color,'border')} pl-3">${s.detail}</p>
                        </div>
                    </div>`).join('')}
                </div>
            </div>
        </div>`;
    }

    // â”€â”€ INTERACTIVE DEMO â”€â”€
    h += `<div id="section-demo" class="mb-16 scroll-mt-28">
        <h3 class="text-2xl font-black mb-8 text-center">ğŸ”¬ Interactive Demo</h3>
        <div class="glass rounded-2xl p-6" id="demoArea">${renderDemo(index)}</div>
    </div>`;

    // â”€â”€ EXAMPLES â”€â”€
    h += `<div id="section-examples" class="mb-16 scroll-mt-28">
        <h3 class="text-2xl font-black mb-8 text-center">ğŸ“‹ Real-World Examples</h3>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">${renderExamples(index)}</div>
    </div>`;

    // â”€â”€ CODE SNIPPETS â”€â”€
    if (a.codeSnippets) {
        h += `<div id="section-code" class="mb-16 scroll-mt-28">
            <h3 class="text-2xl font-black mb-8 text-center">ğŸ’» Code: Vulnerable vs Secure</h3>
            <div class="grid md:grid-cols-2 gap-6">`;
        if (a.codeSnippets.vulnerable) {
            h += `<div>
                <div class="flex items-center gap-2 mb-3"><span class="w-3 h-3 rounded-full bg-red-500"></span><span class="text-red-400 font-bold text-sm">âŒ VULNERABLE</span></div>
                <div class="code-block">
                    <div class="code-header"><span class="text-xs text-gray-400">${a.codeSnippets.vulnerable.title}</span><span class="text-[10px] px-2 py-0.5 rounded-full bg-red-500/20 text-red-400 mono">${a.codeSnippets.vulnerable.lang}</span></div>
                    <pre class="code-body text-red-300/80 mono">${escapeHTML(a.codeSnippets.vulnerable.code)}</pre>
                </div>
            </div>`;
        }
        if (a.codeSnippets.secure) {
            h += `<div>
                <div class="flex items-center gap-2 mb-3"><span class="w-3 h-3 rounded-full bg-green-500"></span><span class="text-green-400 font-bold text-sm">âœ… SECURE</span></div>
                <div class="code-block">
                    <div class="code-header"><span class="text-xs text-gray-400">${a.codeSnippets.secure.title}</span><span class="text-[10px] px-2 py-0.5 rounded-full bg-green-500/20 text-green-400 mono">${a.codeSnippets.secure.lang}</span></div>
                    <pre class="code-body text-green-300/80 mono">${escapeHTML(a.codeSnippets.secure.code)}</pre>
                </div>
            </div>`;
        }
        h += `</div></div>`;
    }

    // â”€â”€ REAL WORLD CASES â”€â”€
    if (a.realWorldCases && a.realWorldCases.length) {
        h += `<div id="section-cases" class="mb-16 scroll-mt-28">
            <h3 class="text-2xl font-black mb-8 text-center">ğŸ“° Real-World Case Studies</h3>
            <div class="space-y-4">
                ${a.realWorldCases.map(c => `
                <div class="glass rounded-2xl p-5 card-hover flex gap-4 items-start">
                    <div class="flex-shrink-0 w-16 h-16 rounded-xl bg-gradient-to-br ${gc} flex items-center justify-center font-black text-lg">${c.year}</div>
                    <div class="flex-1">
                        <h4 class="font-bold mb-1">${c.title}</h4>
                        <p class="text-sm text-gray-400">${c.desc}</p>
                    </div>
                </div>`).join('')}
            </div>
        </div>`;
    }

    // â”€â”€ PREVENTION â”€â”€
    if (a.prevention && a.prevention.length) {
        h += `<div id="section-prevention" class="mb-16 scroll-mt-28">
            <h3 class="text-2xl font-black mb-8 text-center">ğŸ›¡ï¸ How to Protect Yourself</h3>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                ${a.prevention.map(t => `
                <div class="rounded-xl p-5 border-l-4 ${prioColor(t.priority)} backdrop-blur-lg card-hover">
                    <div class="flex items-center gap-2 mb-2"><span class="text-2xl">${t.icon}</span>${dangerBadge(t.priority)}</div>
                    <h4 class="font-bold text-sm mb-2">${t.tip}</h4>
                    <p class="text-xs text-gray-400 leading-relaxed">${t.desc}</p>
                </div>`).join('')}
            </div>
        </div>`;
    }

    // â”€â”€ QUIZ â”€â”€
    h += `<div id="section-quiz" class="mb-16 scroll-mt-28">
        <h3 class="text-2xl font-black mb-8 text-center">ğŸ§  Knowledge Quiz</h3>
        <div class="glass rounded-2xl p-6 max-w-2xl mx-auto" id="quizBox"></div>
    </div>`;

    container.innerHTML = h;
    renderQuiz();
    // Auto-initialize IDN character breakdown if visible
    if (a.id === 'idn' && a.examples && a.examples.length) {
        setTimeout(() => showIDNExample(0), 100);
    }
}

function escapeHTML(str) {
    return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DEMO RENDERERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderDemo(index) {
    const a = CONFIG.attacks[index];
    switch(a.id) {
        case 'rtl': return renderRTLDemo();
        case 'tabnab': return renderTabNabDemo();
        case 'clickjack': return renderClickJackDemo();
        case 'typo': return renderTypoDemo();
        case 'idn': return renderIDNDemo();
        default: return `<p class="text-center text-gray-500">Interactive demo for this attack type.</p>`;
    }
}

function renderRTLDemo() {
    const ex = CONFIG.attacks.find(a=>a.id==='rtl')?.examples || [];
    if (!ex.length) return '<p class="text-gray-500 text-center">No examples configured.</p>';
    return `
        <p class="text-sm text-gray-400 mb-6 text-center">See how the RLO character reverses the displayed file extension. Click any file to inspect it.</p>
        <div class="grid md:grid-cols-2 gap-6">
            <div class="rounded-xl border border-green-500/30 bg-green-500/5 p-5">
                <div class="flex items-center gap-2 mb-4"><span class="w-3 h-3 rounded-full bg-green-500 animate-pulse"></span><span class="text-green-400 font-bold text-sm">WHAT YOU SEE (File Explorer)</span></div>
                <div class="space-y-2">
                    ${ex.map((e,i) => `
                    <div class="flex items-center gap-3 p-3 rounded-lg bg-gray-800/50 cursor-pointer hover:bg-gray-700/50 transition group" onclick="selectRTLExample(${i})">
                        <span class="text-2xl group-hover:scale-110 transition-transform">${e.fakeExt==='.pdf'?'ğŸ“„':e.fakeExt==='.png'?'ğŸ–¼ï¸':e.fakeExt==='.txt'?'ğŸ“':e.fakeExt==='.mp3'?'ğŸµ':e.fakeExt==='.doc'?'ğŸ“„':'ğŸ“Š'}</span>
                        <div class="flex-1 min-w-0"><p class="mono text-sm text-green-300 truncate">${e.appearsAs}</p><p class="text-[10px] text-gray-500">Appears to be a ${e.fakeExt} file</p></div>
                        ${dangerBadge(e.danger)}
                    </div>`).join('')}
                </div>
            </div>
            <div class="rounded-xl border border-red-500/30 bg-red-500/5 p-5">
                <div class="flex items-center gap-2 mb-4"><span class="w-3 h-3 rounded-full bg-red-500 animate-pulse"></span><span class="text-red-400 font-bold text-sm">REALITY (Actual File)</span></div>
                <div id="rtlReality" class="p-4 rounded-lg bg-gray-800/80 mb-4">
                    <p class="text-xs text-gray-500 mb-3">Click a file on the left to inspect:</p>
                    <div id="rtlDetail">
                        <p class="mono text-red-300 text-lg mb-3 break-all">ğŸ“ ${ex[0].realName.replace('\u202E','<span class="px-1.5 py-0.5 bg-red-500/30 rounded text-red-300 text-[10px] mx-1 font-bold">[U+202E RLO]</span>')}</p>
                        <div class="space-y-1.5">
                            <p class="text-xs text-gray-400">âš ï¸ Actual Extension: <span class="text-red-400 font-bold text-sm">${ex[0].actualExt}</span></p>
                            <p class="text-xs text-gray-400">ğŸ­ Appears As: <span class="text-green-400 font-bold">${ex[0].fakeExt}</span></p>
                        </div>
                        <p class="text-xs text-yellow-400 mt-3 p-2 rounded-lg bg-yellow-500/10">ğŸ’¡ ${ex[0].description}</p>
                    </div>
                </div>
                <div class="p-3 rounded-lg bg-purple-500/10 border border-purple-500/30">
                    <p class="text-xs text-purple-300"><strong>âš¡ How RLO Works:</strong> The invisible U+202E character reverses all text after it. So 'fdp.exe' renders as 'exe.pdf' on screen!</p>
                </div>
            </div>
        </div>`;
}

function renderTabNabDemo() {
    return `
        <p class="text-sm text-gray-400 mb-6 text-center">Click the link in the email below to see how tab-nabbing works (simulated safely).</p>
        <div class="grid md:grid-cols-3 gap-4 items-start">
            <div class="demo-frame">
                <div class="demo-titlebar"><span class="demo-dot bg-red-500"></span><span class="demo-dot bg-yellow-500"></span><span class="demo-dot bg-green-500"></span><span class="text-xs text-gray-400 ml-2 mono" id="tabUrl1">gmail.com/inbox</span></div>
                <div id="tabDemoOriginal" class="bg-gray-900 p-4 min-h-[220px]">
                    <div class="flex items-center gap-2 mb-3"><span class="text-2xl">ğŸ“§</span><span class="font-bold text-sm">Gmail â€” Inbox</span></div>
                    <div class="space-y-2 text-xs">
                        <div class="p-2 rounded bg-gray-800 flex justify-between"><span>ğŸ“¬ Security alert from Google</span><span class="text-gray-600">2m</span></div>
                        <div class="p-2 rounded bg-gray-800 flex justify-between"><span>ğŸ“¬ Team meeting notes</span><span class="text-gray-600">1h</span></div>
                        <div class="p-2.5 rounded bg-blue-500/10 border border-blue-500/30 cursor-pointer hover:bg-blue-500/20 transition" onclick="simulateTabNab()">
                            <span class="text-blue-300">ğŸ”— "Check out this amazing article!"</span>
                            <p class="text-gray-500 mt-1">From: friend@email.com â€” Click to open</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex items-center justify-center">
                <div class="text-center">
                    <div class="text-4xl mb-2">â¡ï¸</div>
                    <p class="text-[10px] text-gray-600">New tab opens</p>
                </div>
            </div>
            <div class="demo-frame">
                <div class="demo-titlebar"><span class="demo-dot bg-red-500"></span><span class="demo-dot bg-yellow-500"></span><span class="demo-dot bg-green-500"></span><span class="text-xs text-gray-400 ml-2 mono" id="tabUrl2">waiting...</span></div>
                <div id="tabDemoNew" class="bg-gray-900 p-4 min-h-[220px] flex items-center justify-center">
                    <p class="text-gray-500 text-sm text-center">ğŸ‘† Click the link in the email to start the demo</p>
                </div>
            </div>
        </div>
        <div id="tabNabAlert" class="hidden mt-4 p-4 rounded-xl bg-red-500/10 border border-red-500/30 text-center animate-fade-in">
            <p class="text-red-400 font-bold text-lg mb-1">ğŸš¨ Tab Has Been Nabbed!</p>
            <p class="text-sm text-gray-400">The original Gmail tab has been silently replaced with a fake login page! Look at the left panel â€” it's now a phishing page.</p>
        </div>`;
}

function renderClickJackDemo() {
    const a = CONFIG.attacks.find(a=>a.id==='clickjack');
    const ex = a?.examples || [];
    return `
        <p class="text-sm text-gray-400 mb-6 text-center">Click the "Play" button and see what actually happens behind the scenes.</p>
        <div class="grid md:grid-cols-2 gap-6">
            <div>
                <div class="demo-frame">
                    <div class="demo-titlebar"><span class="demo-dot bg-red-500"></span><span class="demo-dot bg-yellow-500"></span><span class="demo-dot bg-green-500"></span><span class="text-xs text-gray-400 ml-2">free-movies-hd.com</span></div>
                    <div class="bg-gray-900 p-6 text-center relative" id="clickjackArea">
                        <div class="bg-gradient-to-b from-gray-800 to-gray-900 rounded-xl p-8 mb-4">
                            <p class="text-5xl mb-3">ğŸ¬</p>
                            <p class="font-bold text-lg mb-1">Avengers: Secret Wars</p>
                            <p class="text-xs text-gray-500 mb-5">HD Quality â€¢ Free Stream â€¢ No Signup</p>
                            <button onclick="clickJackClick()" class="px-8 py-3 bg-gradient-to-r from-green-500 to-cyan-500 rounded-xl font-bold text-lg hover:scale-105 active:scale-95 transition-all shadow-lg relative z-10" id="clickjackBtn">
                                â–¶ï¸ Play Movie Free
                            </button>
                        </div>
                        <p class="text-[10px] text-gray-600">The invisible iframe is right over this button â†‘</p>
                        <div id="clickjackOverlay" class="absolute inset-0 rounded-b-xl pointer-events-none transition-all duration-500"></div>
                    </div>
                </div>
                <button onclick="toggleOverlay()" class="mt-3 w-full py-2.5 rounded-lg bg-gray-800 text-sm text-gray-400 hover:bg-gray-700 hover:text-white transition flex items-center justify-center gap-2">
                    <span>ğŸ‘ï¸</span> <span id="overlayToggleText">Reveal Hidden Layer</span>
                </button>
            </div>
            <div>
                <div id="clickjackResult" class="demo-frame mb-4">
                    <div class="demo-titlebar"><span class="demo-dot bg-red-500"></span><span class="demo-dot bg-yellow-500"></span><span class="demo-dot bg-green-500"></span><span class="text-xs text-gray-400 ml-2">What Actually Happens</span></div>
                    <div class="bg-gray-900 p-6 min-h-[250px] flex items-center justify-center">
                        <p class="text-gray-500 text-sm text-center">ğŸ‘† Click the "Play" button to see the result</p>
                    </div>
                </div>
                <div class="space-y-2">
                    <p class="text-xs text-gray-500 font-bold mb-2">Hidden actions behind innocent buttons:</p>
                    ${ex.slice(0,4).map(e => `<div class="flex items-center gap-2 text-xs p-2.5 rounded-lg bg-gray-800/50 glass"><span class="text-green-400 flex-shrink-0">${e.visible}</span><span class="text-gray-600">â†’</span><span class="text-red-400 flex-shrink-0">${e.actual}</span><span class="ml-auto">${dangerBadge(e.danger)}</span></div>`).join('')}
                </div>
            </div>
        </div>`;
}

function renderTypoDemo() {
    const a = CONFIG.attacks.find(a=>a.id==='typo');
    const types = a?.typoTypes || [];
    return `
        <p class="text-sm text-gray-400 mb-6 text-center">Type any domain below to generate common typosquatting variants, or explore the pre-built examples.</p>
        <div class="flex gap-3 mb-6 max-w-xl mx-auto">
            <input type="text" id="typoInput" placeholder="Enter a domain (e.g., google.com)" class="flex-1 px-4 py-3 rounded-xl bg-gray-800 border border-gray-600 focus:border-yellow-500 focus:outline-none mono text-sm transition" onkeydown="if(event.key==='Enter')generateTypos()">
            <button onclick="generateTypos()" class="px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-xl font-bold hover:scale-105 active:scale-95 transition-all shadow-lg">âš¡ Generate</button>
        </div>
        <div class="flex flex-wrap justify-center gap-2 mb-6">
            ${['google.com','amazon.com','facebook.com','paypal.com','twitter.com'].map(d=>`<button onclick="document.getElementById('typoInput').value='${d}';generateTypos()" class="px-3 py-1.5 rounded-full text-xs glass text-gray-400 hover:text-white hover:bg-gray-800 transition mono">${d}</button>`).join('')}
        </div>
        <div id="typoResults" class="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6">
            ${types.map(t => `
            <div class="glass rounded-xl p-4 card-hover">
                <p class="text-[10px] text-gray-500 uppercase tracking-wider mb-2 font-bold">${t.type}</p>
                <p class="mono text-green-400 text-sm">${t.real}</p>
                <p class="text-gray-600 text-center text-xs my-1">â†“ typo</p>
                <p class="mono text-red-400 text-sm font-bold">${t.typo}</p>
                <p class="text-[11px] text-gray-500 mt-2 leading-relaxed">${t.description}</p>
            </div>`).join('')}
        </div>
        <div class="p-4 rounded-xl bg-yellow-500/10 border border-yellow-500/30 text-center">
            <p class="text-sm text-yellow-400">âš¡ Attackers register <strong>thousands</strong> of typo variants for popular domains â€” catching users who make even a single keystroke mistake!</p>
        </div>`;
}

function renderIDNDemo() {
    const a = CONFIG.attacks.find(a=>a.id==='idn');
    const ex = a?.examples || [];
    const conf = a?.confusables || [];
    if (!ex.length) return '<p class="text-gray-500 text-center">No IDN examples configured.</p>';
    return `
        <p class="text-sm text-gray-400 mb-6 text-center">Can you spot the difference between real and fake domains? Select one below to analyze it.</p>
        <div class="flex flex-wrap justify-center gap-2 mb-6">
            ${ex.map((e,i) => `<button onclick="showIDNExample(${i})" class="idn-btn px-4 py-2 rounded-full text-sm mono glass hover:border-purple-500/50 transition ${i===0?'bg-gradient-to-r from-purple-500 to-pink-500 text-white':''}" data-idx="${i}">${e.real}</button>`).join('')}
        </div>
        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <div class="rounded-xl border border-green-500/30 bg-green-500/5 p-5">
                <div class="flex items-center gap-2 mb-4"><span class="w-3 h-3 rounded-full bg-green-500"></span><span class="text-green-400 font-bold text-sm">âœ… REAL DOMAIN</span></div>
                <div class="rounded-full bg-gray-800 border-2 border-green-500/50 px-5 py-3 flex items-center gap-3 mb-4"><span class="text-green-400">ğŸ”’</span><span class="mono text-lg" id="idnReal">${ex[0].real}</span></div>
                <p class="text-xs text-gray-500 mb-2">Character breakdown:</p>
                <div id="idnRealChars" class="flex flex-wrap gap-1"></div>
            </div>
            <div class="rounded-xl border border-red-500/30 bg-red-500/5 p-5">
                <div class="flex items-center gap-2 mb-4"><span class="w-3 h-3 rounded-full bg-red-500"></span><span class="text-red-400 font-bold text-sm">âŒ FAKE DOMAIN</span></div>
                <div class="rounded-full bg-gray-800 border-2 border-red-500/50 px-5 py-3 flex items-center gap-3 mb-4"><span class="text-green-400">ğŸ”’</span><span class="mono text-lg glitch" id="idnFake">${ex[0].fake}</span></div>
                <p class="text-xs text-gray-500 mb-2">Character breakdown (âš ï¸ = spoofed):</p>
                <div id="idnFakeChars" class="flex flex-wrap gap-1"></div>
            </div>
        </div>
        <div class="glass rounded-xl p-4 text-center mb-6">
            <p class="text-xs text-gray-500 mb-1">Punycode representation (what the browser actually sees):</p>
            <p class="mono text-lg text-purple-400 font-bold" id="idnPunycode">${ex[0].punycode}</p>
        </div>
        ${conf.length ? `<div class="mb-6">
            <h4 class="text-sm font-bold text-center mb-4 text-gray-400">ğŸ”¤ Confusable Characters Reference Table</h4>
            <div class="glass rounded-xl overflow-hidden"><div class="overflow-x-auto"><table class="w-full text-sm">
                <thead><tr class="bg-gray-800/50 text-left text-xs"><th class="px-4 py-3 text-green-400">Latin Char</th><th class="px-4 py-3 text-red-400">Look-alike</th><th class="px-4 py-3 text-purple-400">Script</th><th class="px-4 py-3 text-yellow-400">Unicode</th></tr></thead>
                <tbody>${conf.map(c=>`<tr class="border-t border-gray-800/50 hover:bg-gray-800/20 transition"><td class="px-4 py-2 mono text-2xl text-green-400">${c.latin}</td><td class="px-4 py-2 mono text-2xl text-red-400">${c.lookalike}</td><td class="px-4 py-2 text-xs text-gray-400">${c.script}</td><td class="px-4 py-2 mono text-xs text-yellow-400">${c.unicode}</td></tr>`).join('')}</tbody>
            </table></div></div>
        </div>` : ''}
        <div class="glass rounded-xl p-5">
            <h4 class="font-bold text-sm mb-3">ğŸ” Domain Safety Checker</h4>
            <p class="text-xs text-gray-500 mb-3">Paste any domain to check for suspicious non-ASCII characters:</p>
            <div class="flex gap-2 mb-3">
                <input type="text" id="idnCheckInput" placeholder="Paste a domain to analyze..." class="flex-1 px-4 py-2.5 rounded-lg bg-gray-800 border border-gray-600 focus:border-purple-500 focus:outline-none mono text-sm transition" onkeydown="if(event.key==='Enter')checkIDN()">
                <button onclick="checkIDN()" class="px-5 py-2.5 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg font-bold hover:scale-105 active:scale-95 transition-all">Analyze</button>
            </div>
            <div class="flex flex-wrap gap-1 mb-3">
                ${ex.slice(0,4).map(e=>`<button onclick="document.getElementById('idnCheckInput').value='${e.fake}';checkIDN()" class="text-[10px] px-2 py-1 rounded-full bg-gray-800 hover:bg-gray-700 mono text-gray-400 transition">${e.fake}</button>`).join('')}
            </div>
            <div id="idnCheckResult"></div>
        </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  EXAMPLES RENDERER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderExamples(index) {
    const a = CONFIG.attacks[index];
    switch(a.id) {
        case 'rtl':
            return (a.examples||[]).map(e => `
            <div class="glass rounded-xl p-5 card-hover">
                <div class="flex justify-between items-center mb-3">${dangerBadge(e.danger)}<span class="text-[10px] text-gray-500 mono">${e.actualExt} â†’ ${e.fakeExt}</span></div>
                <p class="text-[10px] text-gray-500 mb-1 uppercase tracking-wider">Displayed as:</p>
                <p class="mono text-green-400 mb-2 text-sm">${e.appearsAs}</p>
                <p class="text-[10px] text-gray-500 mb-1 uppercase tracking-wider">Real filename:</p>
                <p class="mono text-red-400 text-sm mb-3 break-all">${e.realName.replace('\u202E','[RLO]')}</p>
                <p class="text-xs text-gray-400 border-t border-gray-700/50 pt-3">${e.description}</p>
            </div>`).join('');
        case 'tabnab':
            return (a.examples||[]).map(e => `
            <div class="glass rounded-xl p-5 card-hover">
                <div class="flex justify-between items-center mb-3">${dangerBadge(e.danger)}<span class="text-[10px] text-gray-500">${e.scenario}</span></div>
                <p class="text-[10px] text-gray-500 mb-1 uppercase tracking-wider">Original tab becomes:</p>
                <p class="mono text-red-400 font-bold mb-3">${e.target}</p>
                <p class="text-xs text-gray-400 border-t border-gray-700/50 pt-3">${e.description}</p>
            </div>`).join('');
        case 'clickjack':
            return (a.examples||[]).map(e => `
            <div class="glass rounded-xl p-5 card-hover">
                <div class="mb-3">${dangerBadge(e.danger)}</div>
                <p class="text-[10px] text-gray-500 mb-1 uppercase tracking-wider">What you see:</p>
                <p class="text-green-400 font-bold mb-2">${e.visible}</p>
                <p class="text-[10px] text-gray-500 mb-1 uppercase tracking-wider">What actually clicks:</p>
                <p class="text-red-400 font-bold mb-3">${e.actual}</p>
                <p class="text-xs text-gray-400 border-t border-gray-700/50 pt-3">${e.description}</p>
            </div>`).join('');
        case 'typo':
            return (a.typoTypes||[]).map(t => `
            <div class="glass rounded-xl p-5 card-hover">
                <span class="text-[10px] px-2 py-1 rounded-full bg-yellow-500/20 text-yellow-400 font-bold uppercase tracking-wider">${t.type}</span>
                <div class="flex items-center gap-3 my-3">
                    <span class="mono text-green-400 text-sm">${t.real}</span>
                    <span class="text-gray-600">â†’</span>
                    <span class="mono text-red-400 text-sm font-bold">${t.typo}</span>
                </div>
                <p class="text-xs text-gray-400 border-t border-gray-700/50 pt-3">${t.description}</p>
            </div>`).join('');
        case 'idn':
            return (a.examples||[]).map(e => `
            <div class="glass rounded-xl p-5 card-hover">
                <div class="flex justify-between items-center mb-3"><span class="text-[10px] px-2 py-1 rounded-full bg-purple-500/20 text-purple-400 font-bold">${e.category}</span>${dangerBadge(e.danger)}</div>
                <p class="text-[10px] text-gray-500 mb-1">Real:</p><p class="mono text-green-400 mb-1">${e.real}</p>
                <p class="text-[10px] text-gray-500 mb-1">Fake:</p><p class="mono text-red-400 font-bold mb-1 glitch">${e.fake}</p>
                <p class="text-[10px] text-gray-500 mb-1">Punycode:</p><p class="mono text-purple-400 text-xs mb-2 break-all">${e.punycode}</p>
                <div class="border-t border-gray-700/50 pt-2 space-y-1">${(e.chars||[]).map(c=>`<div class="flex items-center gap-2 text-[11px]"><span class="text-green-400 mono">${c.real}</span><span class="text-gray-600">â†’</span><span class="text-red-400 mono">${c.fake}</span></div>`).join('')}</div>
            </div>`).join('');
        default: return '';
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INTERACTIVE FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function selectRTLExample(i) {
    const a = CONFIG.attacks.find(a=>a.id==='rtl');
    const ex = a?.examples?.[i];
    if (!ex) return;
    const detail = document.getElementById('rtlDetail');
    detail.className = 'animate-fade-in';
    detail.innerHTML = `
        <p class="mono text-red-300 text-lg mb-3 break-all">ğŸ“ ${ex.realName.replace('\u202E','<span class="px-1.5 py-0.5 bg-red-500/30 rounded text-red-300 text-[10px] mx-1 font-bold">[U+202E RLO]</span>')}</p>
        <div class="space-y-1.5">
            <p class="text-xs text-gray-400">âš ï¸ Actual Extension: <span class="text-red-400 font-bold text-sm">${ex.actualExt}</span></p>
            <p class="text-xs text-gray-400">ğŸ­ Appears As: <span class="text-green-400 font-bold">${ex.fakeExt}</span></p>
            <p class="text-xs text-gray-400">â˜ ï¸ Danger Level: ${dangerBadge(ex.danger)}</p>
        </div>
        <p class="text-xs text-yellow-400 mt-3 p-2 rounded-lg bg-yellow-500/10">ğŸ’¡ ${ex.description}</p>`;
}

function simulateTabNab() {
    if (tabNabbed) return;
    tabNabbed = true;
    document.getElementById('tabDemoNew').innerHTML = `<div class="text-center py-6 animate-fade-in"><p class="text-5xl mb-3">ğŸ“°</p><p class="font-bold">Cool Article Website</p><p class="text-sm text-gray-400 mt-2">A very interesting article...</p><p class="text-xs text-yellow-400 mt-4 animate-pulse">â³ Meanwhile, the original tab is being hijacked...</p></div>`;
    document.getElementById('tabUrl2').textContent = 'cool-article.com';

    setTimeout(() => {
        const orig = document.getElementById('tabDemoOriginal');
        document.getElementById('tabUrl1').textContent = 'accounts.google.com/signin';
        orig.innerHTML = `
            <div class="p-4 animate-fade-in">
                <div class="text-center mb-4"><span class="text-4xl">ğŸ”</span>
                <p class="font-bold text-sm mt-2">Sign in to Google</p>
                <p class="text-xs text-gray-500">Your session has expired</p></div>
                <div class="space-y-3">
                    <input class="w-full px-3 py-2 rounded-lg bg-gray-800 border border-gray-600 text-sm" placeholder="Email" value="user@gmail.com" readonly>
                    <input type="password" class="w-full px-3 py-2 rounded-lg bg-gray-800 border border-gray-600 text-sm" placeholder="Password">
                    <button class="w-full py-2.5 bg-blue-600 rounded-lg text-sm font-bold hover:bg-blue-700 transition">Sign In</button>
                </div>
                <p class="text-[10px] text-red-400 mt-3 text-center font-bold p-2 bg-red-500/10 rounded-lg">âš ï¸ THIS IS FAKE! Not real Gmail â€” credentials would go to the attacker!</p>
            </div>`;
        document.getElementById('tabNabAlert').classList.remove('hidden');
    }, 2000);
}

function toggleOverlay() {
    overlayVisible = !overlayVisible;
    const overlay = document.getElementById('clickjackOverlay');
    const text = document.getElementById('overlayToggleText');
    if (overlayVisible) {
        overlay.style.border = '3px dashed rgba(239,68,68,0.8)';
        overlay.style.background = 'rgba(239,68,68,0.08)';
        overlay.innerHTML = '<div class="absolute inset-0 flex items-center justify-center"><div class="bg-red-500/90 px-5 py-3 rounded-xl text-sm font-bold animate-pulse pointer-events-none shadow-xl">ğŸ‘» INVISIBLE IFRAME<br><span class="text-xs font-normal">ğŸ’¸ bank.com/transfer?confirm=true</span></div></div>';
        text.textContent = 'Hide Layer';
    } else {
        overlay.style.border = 'none';
        overlay.style.background = 'transparent';
        overlay.innerHTML = '';
        text.textContent = 'Reveal Hidden Layer';
    }
}

function clickJackClick() {
    const a = CONFIG.attacks.find(a=>a.id==='clickjack');
    const ex = a?.examples?.[0];
    const result = document.getElementById('clickjackResult');
    result.innerHTML = `
        <div class="demo-titlebar"><span class="demo-dot bg-red-500"></span><span class="demo-dot bg-yellow-500"></span><span class="demo-dot bg-green-500"></span><span class="text-xs text-red-400 ml-2 font-bold">âš ï¸ HIJACKED</span></div>
        <div class="bg-gray-900 p-6 text-center animate-fade-in">
            <div class="text-5xl mb-3 animate-shake">ğŸš¨</div>
            <p class="text-red-400 font-bold text-xl mb-2">CLICK-JACKED!</p>
            <p class="text-sm text-gray-400 mb-4">You clicked "Play Movie", but actually triggered:</p>
            <div class="p-4 rounded-xl bg-red-500/10 border border-red-500/30 mb-3">
                <p class="text-red-400 font-bold text-lg">${ex ? ex.actual : 'ğŸ’¸ Bank Transfer Confirmed!'}</p>
            </div>
            <p class="text-xs text-gray-500">${ex ? ex.description : 'The invisible iframe intercepted your click.'}</p>
        </div>`;
}

function generateTypos() {
    const input = document.getElementById('typoInput').value.trim();
    if (!input) return;
    const domain = input.replace(/^https?:\/\//,'').split('/')[0];
    const parts = domain.split('.');
    const name = parts[0] || domain;
    const ext = parts.slice(1).join('.') || 'com';
    const typos = [];
    const adj = {q:'wa',w:'qe',e:'wr',r:'et',t:'ry',y:'tu',u:'yi',i:'uo',o:'ip',p:'ol',a:'sq',s:'ad',d:'sf',f:'dg',g:'fh',h:'gj',j:'hk',k:'jl',l:'k',z:'xa',x:'zc',c:'xv',v:'cb',b:'vn',n:'bm',m:'n'};

    for(let i=0;i<name.length;i++) typos.push({type:'Missing Letter',typo:name.slice(0,i)+name.slice(i+1)+'.'+ext});
    for(let i=0;i<name.length;i++) typos.push({type:'Double Letter',typo:name.slice(0,i)+name[i]+name[i]+name.slice(i+1)+'.'+ext});
    for(let i=0;i<name.length;i++){const k=name[i].toLowerCase();if(adj[k]){typos.push({type:'Adjacent Key',typo:name.slice(0,i)+adj[k][0]+name.slice(i+1)+'.'+ext});}}
    if(name.length>2){for(let i=0;i<name.length-1;i++) typos.push({type:'Swapped Letters',typo:name.slice(0,i)+name[i+1]+name[i]+name.slice(i+2)+'.'+ext});}
    ['co','net','org','io','xyz','biz'].forEach(t=>{if(t!==ext) typos.push({type:'Wrong TLD',typo:name+'.'+t});});
    typos.push({type:'Added Hyphen',typo:name.slice(0,Math.ceil(name.length/2))+'-'+name.slice(Math.ceil(name.length/2))+'.'+ext});
    typos.push({type:'Plural',typo:name+'s.'+ext});
    typos.push({type:'Missing Dot',typo:'www'+name+'.'+ext});

    const unique = [...new Map(typos.map(t=>[t.typo,t])).values()].filter(t=>t.typo!==domain).slice(0,16);
    document.getElementById('typoResults').innerHTML = unique.map(t=>`
        <div class="glass rounded-xl p-3 card-hover animate-fade-in">
            <p class="text-[10px] text-gray-500 uppercase tracking-wider mb-1 font-bold">${t.type}</p>
            <p class="mono text-red-400 text-sm font-bold">${t.typo}</p>
        </div>`).join('');
}

function showIDNExample(i) {
    const a = CONFIG.attacks.find(a=>a.id==='idn');
    const ex = a?.examples?.[i];
    if (!ex) return;
    document.getElementById('idnReal').textContent = ex.real;
    document.getElementById('idnFake').textContent = ex.fake;
    document.getElementById('idnPunycode').textContent = ex.punycode;

    const fakePositions = (ex.chars||[]).map(c=>c.pos);
    let rHtml = '';
    for(let j=0;j<ex.real.length;j++){
        const ch=ex.real[j], code=ch.codePointAt(0).toString(16).toUpperCase().padStart(4,'0');
        rHtml+=`<span class="inline-flex flex-col items-center px-1.5 py-1 rounded bg-green-500/10 border border-green-500/20"><span class="mono text-sm text-green-300">${ch}</span><span class="text-[8px] text-gray-500">U+${code}</span></span>`;
    }
    document.getElementById('idnRealChars').innerHTML=rHtml;

    let fHtml = '';
    for(let j=0;j<ex.fake.length;j++){
        const ch=ex.fake[j], code=ch.codePointAt(0).toString(16).toUpperCase().padStart(4,'0');
        const sus=fakePositions.includes(j);
        fHtml+=`<span class="inline-flex flex-col items-center px-1.5 py-1 rounded ${sus?'bg-red-500/20 border-2 border-red-500 ring-2 ring-red-500/30':'bg-gray-700/50 border border-gray-600'}"><span class="mono text-sm ${sus?'text-red-300':'text-gray-300'}">${ch}</span><span class="text-[8px] ${sus?'text-red-400 font-bold':'text-gray-500'}">U+${code}</span>${sus?'<span class="text-[7px] text-red-400 font-bold">âš ï¸FAKE</span>':''}</span>`;
    }
    document.getElementById('idnFakeChars').innerHTML=fHtml;

    document.querySelectorAll('.idn-btn').forEach((b,idx)=>{
        if(idx===i) b.className='idn-btn px-4 py-2 rounded-full text-sm mono bg-gradient-to-r from-purple-500 to-pink-500 text-white transition';
        else b.className='idn-btn px-4 py-2 rounded-full text-sm mono glass hover:border-purple-500/50 transition';
    });
}

function checkIDN() {
    const input = document.getElementById('idnCheckInput').value.trim();
    const result = document.getElementById('idnCheckResult');
    if(!input){ result.innerHTML=''; return; }
    let suspicious=[], chars=[];
    for(let i=0;i<input.length;i++){
        const ch=input[i],code=ch.codePointAt(0),hex=code.toString(16).toUpperCase().padStart(4,'0');
        const isAscii=code<128, isDot=ch==='.';
        let status='safe',script='ASCII';
        if(!isAscii && !isDot){
            status='suspicious';
            if(code>=0x0400&&code<=0x04FF)script='Cyrillic';
            else if(code>=0x0530&&code<=0x058F)script='Armenian';
            else if(code>=0x0370&&code<=0x03FF)script='Greek';
            else if(code>=0x0250&&code<=0x02AF)script='IPA Extensions';
            else script='Non-ASCII (U+'+hex+')';
            suspicious.push({ch,hex,i,script});
        }
        chars.push({ch,hex,status,isDot});
    }
    const safe=suspicious.length===0;
    result.innerHTML=`
        <div class="rounded-lg p-3 ${safe?'bg-green-500/10 border border-green-500/30':'bg-red-500/10 border border-red-500/30'} mb-3 animate-fade-in">
            <span class="text-lg">${safe?'âœ…':'ğŸš¨'}</span>
            <span class="font-bold text-sm ${safe?'text-green-400':'text-red-400'} ml-2">${safe?'SAFE â€” All ASCII Characters':'DANGER â€” Suspicious Non-ASCII Characters Detected!'}</span>
        </div>
        <div class="flex flex-wrap gap-1 mb-3">${chars.map(c=>`<span class="inline-flex flex-col items-center px-1.5 py-1 rounded ${c.status==='suspicious'?'bg-red-500/20 border-2 border-red-500':'bg-green-500/10 border border-green-500/20'}"><span class="mono text-sm ${c.status==='suspicious'?'text-red-300':'text-green-300'}">${c.ch}</span><span class="text-[8px] text-gray-500">U+${c.hex}</span></span>`).join('')}</div>
        ${suspicious.length?`<div class="space-y-1.5">${suspicious.map(s=>`<div class="flex items-center gap-2 text-xs p-2 rounded-lg bg-red-500/5"><span class="mono text-red-400 bg-red-500/10 px-2 py-1 rounded text-lg">${s.ch}</span><span class="text-gray-400">Position ${s.i} â€” <span class="text-yellow-400 font-bold">${s.script}</span> â€” U+${s.hex}</span></div>`).join('')}</div>`:''}`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  QUIZ ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderQuiz() {
    const a = CONFIG.attacks[activeAttack];
    if(!a.quiz || !a.quiz.length) { document.getElementById('quizBox').innerHTML='<p class="text-gray-500 text-center py-8">No quiz available for this attack.</p>'; return; }
    if(quizState.current >= a.quiz.length){ showQuizScore(); return; }
    const q = a.quiz[quizState.current];
    const gc = colorMap(a.color, 'gradient');
    const tc = colorMap(a.color, 'text');
    document.getElementById('quizBox').innerHTML = `
        <div class="flex justify-between items-center mb-3">
            <span class="text-sm text-gray-400">Question ${quizState.current+1} of ${a.quiz.length}</span>
            <span class="text-sm ${tc} font-bold">Score: ${quizState.score}/${quizState.current}</span>
        </div>
        <div class="w-full bg-gray-800 rounded-full h-2 mb-6">
            <div class="bg-gradient-to-r ${gc} h-2 rounded-full transition-all duration-500" style="width:${(quizState.current/a.quiz.length)*100}%"></div>
        </div>
        <h4 class="text-lg font-bold mb-6">${q.question}</h4>
        <div class="space-y-3" id="qOpts">
            ${q.options.map((o,i)=>`<button onclick="answerQ(${i})" class="q-opt w-full text-left px-5 py-3.5 rounded-xl border border-gray-700 hover:border-orange-500 hover:bg-gray-800/50 transition-all mono text-sm bg-gray-800/30" data-i="${i}"><span class="inline-flex items-center justify-center w-7 h-7 rounded-full bg-gray-700 text-xs font-bold mr-3">${String.fromCharCode(65+i)}</span>${o}</button>`).join('')}
        </div>
        <div id="qFeedback" class="hidden mt-4"></div>`;
}

function answerQ(sel) {
    if(quizState.answered) return;
    quizState.answered=true;
    const a=CONFIG.attacks[activeAttack], q=a.quiz[quizState.current], ok=sel===q.correct;
    if(ok)quizState.score++;
    const gc = colorMap(a.color, 'gradient');
    document.querySelectorAll('.q-opt').forEach((b,i)=>{
        b.style.pointerEvents='none';
        if(i===q.correct)b.className='q-opt w-full text-left px-5 py-3.5 rounded-xl border-2 border-green-500 bg-green-500/10 mono text-sm';
        else if(i===sel&&!ok)b.className='q-opt w-full text-left px-5 py-3.5 rounded-xl border-2 border-red-500 bg-red-500/10 mono text-sm';
        else b.className='q-opt w-full text-left px-5 py-3.5 rounded-xl border border-gray-800 text-gray-600 mono text-sm';
    });
    const fb=document.getElementById('qFeedback');
    fb.classList.remove('hidden');
    fb.innerHTML=`
        <div class="rounded-xl p-4 ${ok?'bg-green-500/10 border border-green-500/30':'bg-red-500/10 border border-red-500/30'} animate-fade-in">
            <p class="font-bold text-sm ${ok?'text-green-400':'text-red-400'} mb-1">${ok?'âœ… Correct!':'âŒ Incorrect!'}</p>
            <p class="text-xs text-gray-400">${q.explanation}</p>
        </div>
        <button onclick="nextQ()" class="mt-4 px-6 py-2.5 bg-gradient-to-r ${gc} rounded-xl text-sm font-bold hover:scale-105 active:scale-95 transition-all shadow-lg">
            ${quizState.current<a.quiz.length-1?'Next Question â†’':'See Results â†’'}
        </button>`;
}

function nextQ(){quizState.current++;quizState.answered=false;renderQuiz();}

function showQuizScore(){
    const a=CONFIG.attacks[activeAttack], pct=Math.round((quizState.score/a.quiz.length)*100);
    const gc = colorMap(a.color, 'gradient');
    const gt = colorMap(a.color, 'gradientText');
    let emoji='ğŸ“š',msg='Keep studying â€” you\'ll get there!';
    if(pct>=80){emoji='ğŸ†';msg='Outstanding! You really know your stuff!';}
    else if(pct>=60){emoji='ğŸ‘';msg='Good effort! Review the topics you missed.';}
    else if(pct>=40){emoji='ğŸ“–';msg='Not bad, but there\'s room to improve.';}

    progressData[a.id] = { completed: true, score: quizState.score, total: a.quiz.length, pct };
    saveProgress();

    document.getElementById('quizBox').innerHTML=`
        <div class="text-center py-8 animate-fade-in">
            <div class="text-6xl mb-4">${emoji}</div>
            <h4 class="text-3xl font-black ${gt} mb-2">${quizState.score}/${a.quiz.length}</h4>
            <p class="text-gray-400 text-lg mb-1">${pct}% Score</p>
            <div class="w-full bg-gray-800 rounded-full h-3 max-w-xs mx-auto mb-4"><div class="bg-gradient-to-r ${gc} h-3 rounded-full transition-all" style="width:${pct}%"></div></div>
            <p class="text-gray-400 mb-6">${msg}</p>
            <div class="flex justify-center gap-3">
                <button onclick="quizState={current:0,score:0,answered:false};renderQuiz()" class="px-6 py-2.5 bg-gradient-to-r ${gc} rounded-xl font-bold hover:scale-105 active:scale-95 transition-all shadow-lg">ğŸ”„ Retry Quiz</button>
                ${activeAttack < CONFIG.attacks.length-1 ? `<button onclick="switchAttack(${activeAttack+1})" class="px-6 py-2.5 rounded-xl font-bold bg-gray-800 hover:bg-gray-700 transition">Next Attack â†’</button>` : ''}
            </div>
            <p class="text-xs text-gray-600 mt-4">âœ… Progress saved automatically</p>
        </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SEARCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleSearch() {
    const bar = document.getElementById('searchBar');
    bar.classList.toggle('hidden');
    if (!bar.classList.contains('hidden')) {
        document.getElementById('searchInput').focus();
    } else {
        document.getElementById('searchResults').innerHTML = '';
    }
}

function handleSearch(e) {
    if (e.key === 'Enter') performSearch();
}

function performSearch() {
    const q = document.getElementById('searchInput').value.trim().toLowerCase();
    if (!q) { document.getElementById('searchResults').innerHTML = ''; return; }
    const results = [];

    CONFIG.attacks.forEach((a,i) => {
        if (a.name.toLowerCase().includes(q) || a.description.toLowerCase().includes(q) || a.tagline.toLowerCase().includes(q)) {
            results.push({ type: 'Attack', title: a.name, desc: a.tagline, action: `switchAttack(${i})`, icon: a.icon });
        }
        (a.prevention||[]).forEach(p => {
            if (p.tip.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q)) {
                results.push({ type: 'Prevention', title: p.tip, desc: `${a.name} â€” ${p.desc.substring(0,80)}...`, action: `switchAttack(${i});setTimeout(()=>scrollToSection('section-prevention'),500)`, icon: p.icon });
            }
        });
    });

    (CONFIG.glossary||[]).forEach(g => {
        if (g.term.toLowerCase().includes(q) || g.definition.toLowerCase().includes(q)) {
            results.push({ type: 'Glossary', title: g.term, desc: g.definition.substring(0,80)+'...', action: `scrollToSection('glossary')`, icon: 'ğŸ“–' });
        }
    });

    const container = document.getElementById('searchResults');
    if (!results.length) {
        container.innerHTML = `<p class="text-sm text-gray-500 py-2">No results for "${q}"</p>`;
        return;
    }
    container.innerHTML = `<div class="space-y-1 max-h-64 overflow-y-auto">${results.slice(0,10).map(r => `
        <button onclick="${r.action};toggleSearch()" class="w-full text-left p-2.5 rounded-lg hover:bg-gray-800 transition flex items-center gap-3">
            <span class="text-xl">${r.icon}</span>
            <div class="flex-1 min-w-0">
                <p class="text-sm font-semibold truncate">${r.title}</p>
                <p class="text-[10px] text-gray-500 truncate">${r.type} â€” ${r.desc}</p>
            </div>
        </button>`).join('')}</div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('DOMContentLoaded', () => {
    loadConfig();
});

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
    if (e.key >= '1' && e.key <= '5') {
        const idx = parseInt(e.key) - 1;
        if (idx < CONFIG?.attacks?.length) switchAttack(idx);
    }
    if (e.key === '/') { e.preventDefault(); toggleSearch(); }
});
</script>

<div id="app"></div>
</body>
</html>
